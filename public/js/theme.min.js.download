(function($){$(window).unload(function(){if(theme_object.post_id){$.ajax({url:theme_object.ajax_url,type:"get",data:{action:"post_views_log",post_id:theme_object.post_id},async:false});}});})(jQuery);jQuery(function($){$("body").on("change",'.post-like-button [type="checkbox"]',function(){var $this=$(this);var $postLikeButton=$this.closest(".post-like-button");var $postLikesWrapper=$(".social-act");$.ajax({url:theme_object.ajax_url,type:"post",data:{action:"post_like",post_id:$this.data("id"),like:$this.val(),type:$this.prop("checked")==true?"add":"remove"},beforeSend:function(){$postLikeButton.attr("disabled","disabled");},error:function(){$postLikeButton.removeAttr("disabled");$this.prop("checked",!$this.prop("checked"));},success:function(response){if($postLikeButton.find(".post-like-count").size()){$postLikeButton.find(".post-like-count").text(response.likes||0);}if($postLikeButton.find(".post-dislike-count").size()){$postLikeButton.find(".post-dislike-count").text(response.dislikes||0);}if(response.likable){$postLikesWrapper.find(".post-like-button").removeAttr("disabled").removeClass("disabled");$postLikesWrapper.find('.post-like-button [type="checkbox"]').removeAttr("disabled").removeClass("disabled");}else{$postLikesWrapper.find('.post-like-button [type="checkbox"]').attr("disabled","disabled");$postLikeButton.attr("disabled","disabled").addClass("disabled");}if(response.restrict){$postLikeButton.attr("disabled","disabled");}$postLikesWrapper.find('.post-like-button [type="checkbox"]').not($this).prop("checked",false);if(!response.login_required){if($this.prop("checked")==true){$postLikeButton.find("i").addClass("clicked");}else{$postLikeButton.find("i").removeClass("clicked");}}if(response.login_required){$this.prop("checked",false);}},complete:function(response){}});});$(".post-like-message").click(function(){$(this).empty();});});jQuery(function($){$("body").on("change",'.comment-like-button [type="checkbox"]',function(){var $this=$(this);var $comment=$(this).closest(".comment-body");var $commentLikeButton=$this.closest(".comment-like-button");$.ajax({url:theme_object.ajax_url,type:"post",data:{action:"comment_like",comment_id:$(this).data("id"),like:$(this).val(),type:$this.prop("checked")==true?"add":"remove"},beforeSend:function(){$commentLikeButton.attr("disabled","disabled");},error:function(){$commentLikeButton.removeAttr("disabled");$this.prop("checked",!$this.prop("checked"));},success:function(response){if($commentLikeButton.find(".comment-like-count").size()){$commentLikeButton.find(".comment-like-count").text(response.likes||0);}if($commentLikeButton.find(".comment-dislike-count")){$commentLikeButton.find(".comment-dislike-count").text(response.dislikes||0);}if(response.likable){$comment.find(".comment-like-button").removeAttr("disabled").removeClass("disabled");$comment.find('.comment-like-button [type="checkbox"]').removeAttr("disabled").removeClass("disabled");}else{$commentLikeButton.find('[type="checkbox"]').attr("disabled","disabled");$commentLikeButton.attr("disabled","disabled").addClass("disabled");}if(response.restrict){$comment.find(".comment-like-button").attr("disabled","disabled");}$comment.find('.comment-like-button [type="checkbox"]').not($this).prop("checked",false);if(!response.login_required){if($this.prop("checked")==true){$commentLikeButton.find("i").addClass("clicked");}else{$commentLikeButton.find("i").removeClass("clicked");}}if(response.login_required){$this.prop("checked",false);}},complete:function(response){}});});$(".comment-like-message").click(function(){$(this).empty();});});jQuery(function($){var starts=$(".stars-wrapper svg"),goldenWidth=percentageWidth($(".stars-wrapper .golden-rate")),goldenColor=$(".stars-wrapper .golden-rate").css("background-color"),startsContainer=$(".post-star-rating"),startsWrapper=$(".post-star-rating .stars-wrapper");starts.hover(function(){var index=$(this).index();$(".stars-wrapper .golden-rate").css({width:index*20+"%",backgroundColor:"#ff637d"});},function(){$(".stars-wrapper .golden-rate").css({width:goldenWidth+"%",backgroundColor:goldenColor});});starts.on("click",function(){var index=$(this).index();goldenWidth=index*20;goldenColor="#ff637d";$(".stars-wrapper .golden-rate").css({width:goldenWidth+"%",backgroundColor:goldenColor});$.ajax({url:theme_object.ajax_url,type:"post",data:{action:"post_star_rating",post_id:theme_object.post_id,vote:index,},beforeSend:function(){startsWrapper.attr("disabled","disabled");},error:function(){startsWrapper.removeAttr("disabled");},success:function(response){startsContainer.next(".rating-message").text(response.vote_message);if(response.rate){startsContainer.find(".post-rate").text(response.rate);startsWrapper.find(".golden-rate").css("width",(response.rate*100)/5+"%");}if(response.votable){startsWrapper.removeAttr("disabled");}else{startsWrapper.attr("disabled","disabled");}},complete:function(response){}});});startsContainer.next(".rating-message").click(function(){$(this).empty();});});jQuery(function($){if(!$("#popup").size()){return false;}$("#popup").popup({onOpen:function(){bodyScroll(false);},onClose:function(){bodyScroll(true);}});if(getCookie("notify_popup")!=popup_notification.expire_date){$("#popup").popup("_create");setCookie("notify_popup",popup_notification.expire_date,5);}else{$("#popup").remove();}$("#popup .popup-close").click(function(){$("#popup").remove();});});jQuery(function($){$(".playlist .playlist-nav li").on("click",function(){var $playlist=$(this).parents(".playlist");var $mediaItems=$playlist.find(".tracks .media-item");var $navItems=$(this).parents(".playlist-nav").find("li");$mediaItems.removeClass("active");$navItems.removeClass("active");$mediaItems.eq($(this).index()).addClass("active");$navItems.eq($(this).index()).addClass("active");var media=$mediaItems.eq($(this).index()).find(".video-js")[0];media.player.play();});});jQuery(".video-download-list .dropdown-toggle").click(function(e){e.preventDefault();jQuery(this).next(".dropdown-menu").toggle();e.stopPropagation();});jQuery(document).click(function(){jQuery(".video-download-list .dropdown-menu").hide();});jQuery(function($){$(".follow-object").on("click",function(e){e.preventDefault();var $this=$(this);$.ajax({url:theme_archive_object.ajax_url,type:"post",data:{action:"follow_object_posts",ajax_nonce:theme_archive_object.theme_ajax_nonce,object_type:theme_archive_object.object_type,object_name:theme_archive_object.object_name,object_id:theme_archive_object.object_id},beforeSend:function(){$this.find(".spinner").remove();$this.addClass("disabled");$this.append('<i class="fa fa-spin fa-spinner fa-pulse fa-fw menu-spinner pull-left"></i>');},success:function(response){$this.find(".spinner").remove();if(response.type=="follow"){$this.addClass("followed");}else{if(response.type=="unfollow"){$this.removeClass("followed");}}$this.text(response.title);$this.removeClass("disabled");}});});});jQuery(function($){$(".following-items .unfollow").on("click",function(e){e.preventDefault();var $this=$(this);dialog(theme_followed_object.unfollow_confirmation,function(){$this.addClass("disabled");$.ajax({url:theme_followed_object.ajax_url,type:"post",data:{action:"unfollow_object_posts",ajax_nonce:theme_followed_object.theme_ajax_nonce,object_type:$this.data("object-type"),object_name:$this.data("name"),object_id:$this.data("id")},beforeSend:function(){$this.find(".spinner").remove();$this.addClass("disabled");},success:function(response){if(response.type=="unfollow"){$this.closest(".followed-item").remove();}}});},function(){});});});function setCookie(cname,cvalue,exdays){var d=new Date();d.setTime(d.getTime()+(exdays*24*60*60*1000));var expires="expires="+d.toUTCString();document.cookie=cname+"="+cvalue+";"+expires+";path=/";}function getCookie(cname){var name=cname+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" "){c=c.substring(1);}if(c.indexOf(name)==0){return c.substring(name.length,c.length);}}return"";}function checkCookie(cname){var name=getCookie(cname);if(name!=""){return true;}else{return false;}}function formatCurrency(num,isRial,symbol){num=num.toString().replace(/\$|\,/g,"");if(isNaN(num)){num="0";}sign=(num==(num=Math.abs(num)));num=Math.floor(num*100+0.50000000001);num=Math.floor(num/(isRial?1000:100)).toString();for(var i=0;i<Math.floor((num.length-(1+i))/3);i++){num=num.substring(0,num.length-(4*i+3))+","+num.substring(num.length-(4*i+3));}return(((sign)?"":"-")+num+" "+symbol);}function ellipsisText(elm){return elm.length>35?elm.substr(0,35)+" ...":elm;}function isUnicode(str){var letters=[];for(var i=0;i<=str.length;i++){letters[i]=str.substring((i-1),i);if(letters[i].charCodeAt()>255){return true;}}return false;}var showNewCategory;var startLoader=function(elem){elem.html('<i class="fa fa-spinner fa-pulse fa-lg fa-fw"></i>');};var stopLoader=function(elem,text){elem.html(text);};function dialog(message,yesCallback,noCallback){jQuery("#confirm-dialog .modal-body p").html(message);jQuery("#confirm-dialog #btnYes").click(function(){jQuery("#confirm-dialog").popup("_close");yesCallback();});jQuery("#confirm-dialog #btnNo").click(function(){jQuery("#confirm-dialog").popup("_close");noCallback();});}function customAlert(message,className,okCallback){if(className.length>0){jQuery("#alert-dialog .modal-body p").addClass(className);}else{jQuery("#alert-dialog .modal-body p").removeAttr("class");}jQuery("#alert-dialog .modal-body p").html(message);jQuery("#alert-dialog").popup("_create");jQuery("#alert-dialog #btnOk").click(function(){jQuery("#alert-dialog").popup("_close");okCallback();});}function resetForm(){document.getElementById("wishlist-form").reset();jQuery("#response-msg").css("visibility","hidden").removeAttr("class").text("");jQuery("#add-to-wishlist").removeAttr("disabled");jQuery("#remove-from-wishlist").removeAttr("disabled");jQuery("#new-category").show();}function submitLoginForm(elem){var form=jQuery(elem);jQuery.ajax({url:theme_object.ajax_url,type:"post",dataType:"json",data:{action:"profile_login",username:form.find("#username").val(),password:form.find("#pwd").val(),remember:form.find("#remember:checkbox:checked").val(),},beforeSend:function(){form.find(".login").addClass("disabled");},success:function(response){if(response.code=="200"||response.code=="300"){location.reload();}else{form.find("#response-msg").text(response.msg).css("display","block").css("visibility","visible");}form.find(".login").removeClass("disabled");}});}function addToWishlist(elem){if(jQuery("#category-selector select").val()==0&&jQuery("#new-category input").val()==""){jQuery("#new-category .error-text").css("visibility","visible");}else{var form=jQuery(elem);var submitBtn=form.find('button[type="submit"]');var innerHtml=submitBtn.html();jQuery(this).attr("disabled","disabled");jQuery.ajax({url:theme_object.ajax_url,type:"post",dataType:"json",data:{action:"add_to_wishlist",category:jQuery("#category-selector select").val(),category_name:jQuery("#new-category input").val(),description:jQuery("#wishlist-desc").val(),post_id:theme_object.post_id},success:function(response){if(response.code=="200"){jQuery("#response-msg").addClass("text-success");jQuery(".wishlist-btn").addClass("clicked");}else{jQuery("#response-msg").addClass("text-danger");}jQuery("#response-msg").text(response.msg).css("visibility","visible");setTimeout(function(){resetForm();jQuery("#wishlistModal").popup("_close");jQuery("#remove-from-wishlist").show();},2000);}});}}jQuery(function($){showNewCategory=function(elem){if(elem.value==="0"){jQuery("#new-category").show();}else{jQuery("#new-category").hide();}};if($("body").hasClass("logged-in")){$.ajax({url:theme_object.ajax_url,type:"post",dataType:"json",data:{action:"check_user_wishlist",post_id:theme_object.post_id},success:function(response){if(response.code=="200"){if(response.wishlist==true){$(".wishlist-btn").addClass("clicked");$("#remove-from-wishlist").show();}else{$(".wishlist-btn").removeClass("clicked");}if(response.bookmark==true){$(".bookmark-btn").find("i").addClass("clicked");}else{$(".bookmark-btn").find("i").removeClass("clicked");}}}});}$(".wishlist-btn").click(function(){if(!$("body").hasClass("logged-in")){$("#response-msg").text(profile_object.login_first).css("visibility","visible");}else{$.ajax({url:theme_object.ajax_url,type:"post",data:{action:"get_categories",post_id:$(this).data("id")},success:function(response){$("#category-selector select").html(response);showNewCategory(document.getElementById("select-category"));}});}});$(".bookmark-btn").click(function(){if(!$("body").hasClass("logged-in")){$("#response-msg").text(profile_object.login_first).css("visibility","visible");}else{elem=$(this);$.ajax({url:theme_object.ajax_url,type:"post",dataType:"json",data:{action:"add_to_bookmark",post_id:elem.data("id")},success:function(response){if(response.code=="200"){response.type=="add"?elem.find("i").addClass("clicked"):elem.find("i").removeClass("clicked");}else{customAlert(response.msg,"text-warning",function(){});}}});}});$("#remove-from-wishlist").click(function(){var elem=$(this);var innerHtml=elem.html();dialog(profile_object.remove_from_wishlist_confirmation,function(){$.ajax({url:theme_object.ajax_url,type:"post",dataType:"json",data:{action:"remove_from_wishlist",post_id:theme_object.post_id},success:function(response){if(response=="200"){$("#response-msg").addClass("text-success").text(profile_object.successful_request).css("visibility","visible");$(".wishlist-btn").removeClass("clicked");setTimeout(function(){resetForm();$("#remove-from-wishlist").hide();},2000);}else{}}});},function(){});});});function submitEditCategory(elem){var form=jQuery(elem);var submitBtn=form.find('button[type="submit"]');var innerHtml=submitBtn.html();submitBtn.attr("disabled","disabled");jQuery.ajax({url:theme_object.ajax_url,type:"post",dataType:"json",data:{action:"edit_category",category_id:form.find("#category-id").val(),title:form.find("#category-title-input").val(),},success:function(response){submitBtn.removeAttr("disabled");if(response.code=="200"){jQuery(".editing").find(".category-title").text(form.find("#category-title-input").val());}else{customAlert(response.msg,"text-warning",function(){});}jQuery("#edit-category-modal").popup("_close");jQuery(".editing").removeClass("editing");}});}jQuery(function($){$(".remove-category-btn").on("click",function(e){e.preventDefault();var elem=$(this);var cat_id=elem.attr("data-id");var row=elem.closest(".category-row");dialog(profile_object.delete_folder_confirmation,function(){var innerHtml=elem.html();elem.addClass("disabled");$.ajax({url:theme_object.ajax_url,type:"post",dataType:"json",data:{action:"remove_category",category_id:cat_id},success:function(response){elem.removeClass("disabled");if(response.code=="200"){row.remove();}else{customAlert(response.msg,"text-warning",function(){});}}});},function(){});});$(".edit-category-btn").on("click",function(e){e.preventDefault();var row=$(this).closest(".category-row");var cat_id=$(this).attr("data-id");var title=$(this).attr("data-title");$("#category-id").val(cat_id);$("#category-title-input").val(title);row.addClass("editing");});$(".remove-from-wishlist").on("click",function(e){e.preventDefault();var elem=$(this);var id=$(this).attr("data-id");var row=elem.closest(".bookmark-item");dialog(profile_object.remove_from_wishlist_confirmation,function(){var innerHtml=elem.html();elem.addClass("disabled");$.ajax({url:theme_object.ajax_url,type:"post",dataType:"json",data:{action:"remove_from_wishlist",id:id},success:function(response){elem.removeClass("disabled");if(response=="200"){row.remove();}}});},function(){});});$(".change-wishlist-status").on("click",function(e){e.preventDefault();var elem=$(this);var id=$(this).attr("data-id");elem.attr("disabled","disabled");$.ajax({url:theme_object.ajax_url,type:"post",dataType:"json",data:{action:"change_wishlist_status",id:id},success:function(response){elem.removeAttr("disabled");if(response=="200"){elem.removeClass("disabled");elem.find('[type="checkbox"]').prop("checked",!elem.find('[type="checkbox"]').prop("checked"));elem.closest(".bookmark-item").toggleClass("read deactivated");}}});});if(getCookie("dk-guid")=="true"){$(".profile-navbar .register").remove();}});function submitQuiz(elem){if(!jQuery("body").hasClass("logged-in")){jQuery("#response-msg").text(profile_object.login_first).css("visibility","visible");}else{if(jQuery("form.quiz-form").serializeArray().length>0){var form=jQuery(elem);var submitBtn=form.find('button[type="submit"]');var innerHtml=submitBtn.html();jQuery.ajax({url:theme_object.ajax_url,type:"post",dataType:"json",data:{action:"submit_quiz",answers:form.serializeArray()},success:function(response){var parent=form.closest(".exam");var $countdown=parent.find(".countdown-timer");if(response.code==200){$countdown.startTimer("resetTimer").startTimer("clearTimer");parent.find(".quiz-form input").attr("disabled","disabled");parent.find('.quiz-form button[type="submit"]').remove();html='<div class="quiz-response-msg alert alert-success" role="alert"><p>پاسخ های شما با موفقیت ارسال شد. با تشکر</p></div>';parent.append(html);}else{customAlert(response.msg,"text-warning",function(){});}}});}else{customAlert("شما به هیچ سوالی پاسخ نداده اید.","text-warning",function(){});}}}function getQuiz(elem){if(!jQuery("body").hasClass("logged-in")){jQuery("#response-msg").text(profile_object.login_first).css("visibility","visible");}else{var elem=jQuery(elem);elem.attr("disabled",true);var innerHtml=elem.html();jQuery.ajax({url:theme_object.ajax_url,type:"post",dataType:"json",data:{action:"get_quiz",id:elem.attr("data-id")},success:function(response){if(response.code==200){var parent=elem.closest(".exam");elem.remove();parent.find(".quiz-form-wrapper").html(response.data);var $quizForm=parent.find(".quiz-form");var $countdown=parent.find(".countdown-timer");$countdown.attr("data-seconds-left",response.time).startTimer({refreshRate:1000,enableDay:false,onComplete:function(element){$countdown.startTimer("resetTimer").startTimer("clearTimer");$quizForm.submit();}});}else{elem.removeAttr("disabled");customAlert(response.msg,"text-warning",function(){});}}});}}jQuery(function($){$(".newsletter-form").submit(function(e){e.preventDefault();var $this=$(this);jQuery.ajax({url:theme_object.ajax_url,type:"post",data:{action:"newsletter_subscribe",email:$this.find("[name=email]").val(),},beforeSend:function(){$this.attr("disabled","disabled");},error:function(){$this.removeAttr("disabled");},success:function(response){if(!response.success){$this.removeAttr("disabled");}$this.resetForm();}});});});jQuery(function(){var $=jQuery;$(".tabular__nav>*").on("click",function(){$(this).parents(".tabular").find(".tabular__nav>*").removeClass("current").parents(".tabular").find(".tabular__panel").removeClass("current");$(this).addClass("current").parents(".tabular").find(".tabular__panel").eq($(this).index()).addClass("current");});$(".pop-up").popup({modal:false,onOpen:function(){bodyScroll(false);$(this).find("input:first").focus();},onClose:function(){bodyScroll(true);}});$(".menu").popup({onOpen:function(){bodyScroll(false);},onClose:function(){bodyScroll(true);}});$(".item__hold .icon-close").on("click",function(){$(this).toggleClass("active").parent().next(".sub-menu").slideToggle(150);});$("label.pu").click(function(event){$("html").one("click",function(){$("input").prop("checked",false);});event.stopPropagation();});$(".order__list").find(".item").on("click",function(){$(this).parents(".order__list").siblings("._txt").text($(this).text());});$("form.comment-form, .comment-reply-link").on("click",function(e){if(!($(e.target).hasClass("cptch_reload_button_wrap")||$(e.target).hasClass("cptch_reload_button"))){e.stopPropagation();}$("form.comment-form").addClass("focused");});$(document).on("click",function(e){if($(e.target).hasClass("cptch_reload_button_wrap")||$(e.target).hasClass("cptch_reload_button")){return;}$("form.comment-form").removeClass("focused");});$("body").on("click",".login-required",function(e){e.preventDefault();jQuery('.pop-up[data-popup="login"]').popup("_create");jQuery(".login-pop__form").find("#response-msg").text(profile_object.login_first).css("display","block").css("visibility","visible");});$(".images-viewer__thumbnails img").on("click",function(){$(this).closest(".images-viewer__thumbnails").prev(".images-viewer__wrapper").find("img").removeClass("shown").eq($(this).closest("li").index()).addClass("shown");});var accordionPanels=$(".accordion__content").hide(),accordionBars=$(".accordion__item");accordionPanels.first().addClass("untie").show();accordionBars.first().addClass("untie");accordionBars.on("click",function(){$this=$(this);$target=$this.next();if(!$target.hasClass("untie")){accordionPanels.removeClass("untie").slideUp();accordionBars.removeClass("untie");$target.addClass("untie").slideDown();$this.addClass("untie");}});checkOrientation();});function checkOrientation(){readDeviceOrientation();function readDeviceOrientation(){if(Math.abs(window.orientation)===90){jQuery("#lock-orientation").removeClass("hidden");jQuery("body").addClass("lock");}else{jQuery("#lock-orientation").addClass("hidden");jQuery("body").removeClass("lock");}}window.onorientationchange=readDeviceOrientation;}function bodyScroll(bool){if(bool){document.body.style.marginRight=0+"px";document.body.style.overflow="visible";document.body.style.backgroundColor="#f6f5f4";}else{document.body.style.marginRight=getScrollbarWidth()+"px";document.body.style.overflow="hidden";document.body.style.backgroundColor="#ffffff";}}function getScrollbarWidth(){var outer=document.createElement("div");outer.style.visibility="hidden";outer.style.width="100px";outer.style.msOverflowStyle="scrollbar";if(document.body==null){return 0;}document.body.appendChild(outer);var widthNoScroll=outer.offsetWidth;outer.style.overflow="scroll";var inner=document.createElement("div");inner.style.width="100%";outer.appendChild(inner);var widthWithScroll=inner.offsetWidth;outer.parentNode.removeChild(outer);return widthNoScroll-widthWithScroll;}function percentageWidth(el){var width=el.width();var parentWidth=el.offsetParent().width();return 100*width/parentWidth;}